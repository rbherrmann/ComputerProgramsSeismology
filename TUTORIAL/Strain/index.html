<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
  <head>
    <meta http-equiv="content-type" content="text/html;
      charset=windows-1252">
    <title>strainspulse96</title>
    <style>
pre {
  background-color: rgb(230,230,230);
  margin-top:12px;
  margin-bottom:12px;
  margin-left:6px;
}
</style>
  </head>
  <body bgcolor="#FFFFFF">
    <h1>Introduction</h1>
    <p>This is an update version of a tutorial on the use of new codes
      for computing stress, strain and rotation in 1-D layered media.
      The earlier version used surface-wave&nbsp; modal superposition to
      make these synthetics. This document now includes wavenumber
      integration to make complete synthetics. The original codes have
      been polished and renamed.&nbsp; This tutorial discusses the
      following codes:<br>
    </p>
    <ul>
      <li><b>srotate96</b> - rotates the computed stress, strains and
        rotation in a cylindrical coordinate system to local Cartesian
        coordinates. It relies on the file extension naming used by the
        synthetic codes and also knows that the stress and strain
        tensors are symmetric and the rotation tensor is anti-symmetric.</li>
      <li><b>spulse96strain </b>- Using the eigenfunctions generated by
        the <b>sprep96</b>, <b>sdisp96</b>, <b>sregn96</b> and <b>slegn96

        </b>sequence, displacement Green's functions can be generated in
        addition to stress, strain and rotation time histories for a
        given point force or moment tensor source.&nbsp; The output time
        series are in Sac binary format.&nbsp; This program can also be
        used to replace the <b>spulse96 | f96tosac </b>sequence to
        create Sac files.<br>
      </li>
      <li><b>hspec96strain&nbsp; </b>used with <b>hpulse96strain</b>
        computes complete solutions for 1-D media using wavenumber
        integration. The penalty for completeness is the extra
        computation time,&nbsp; As with <b>spulse96strain</b>, <b>hpulse96strain

        </b>can be used to replace the <b>hpulse96 | f96tosac </b>sequence

        to yield time series n Sac format.</li>
    </ul>
    The programs <b>srotate96, </b><b>spulse96strain</b><b>, </b><b>hspec96strain</b>
    and <b>hpulse96strain </b>will be part of the first Computer
    Programs in Seismology distribution of 2021. The source codes and
    instructions for incorporation into the previous distributions are
    given below.<br>
    <br>
    <h1>Sections</h1>
    <ul>
      <li><a href="#Distribution"> Distribution</a></li>
      <li><a href="#Theory"> Theory</a></li>
      <li><a href="#Program"> Program usage</a></li>
      <li><a href="#Validation">Validation tests</a></li>
    </ul>
    <p> </p>
    <h1 <a="" name="Distribution">Distribution</h1>
    <p>The new source code and validation codes are given in <a
        href="t.tgz">t.tgz</a>. To unpack this use the command<br>
    </p>
    <pre>gunzip -c t.tgz | tar xf - <br></pre>
    <p> </p>
    which will create the following directory and subdirectories:<br>
    <br>
    <pre><font color="#739FCF"><b>CPSstrain</b></font>
&#9500;&#9472;&#9472; <font color="#739FCF"><b>LAYERF.IMG</b></font>
&#9500;&#9472;&#9472; <font color="#739FCF"><b>LAYERhpulse96strainF</b></font>
&#9500;&#9472;&#9472; <font color="#739FCF"><b>LAYERhpulse96strainS</b></font>
&#9500;&#9472;&#9472; <font color="#739FCF"><b>LAYERhspec</b></font>
&#9474;&nbsp;&nbsp; &#9500;&#9472;&#9472; <font color="#739FCF"><b>WK00</b></font>
&#9474;&nbsp;&nbsp; &#9500;&#9472;&#9472; <font color="#739FCF"><b>WKR+</b></font>
&#9474;&nbsp;&nbsp; &#9500;&#9472;&#9472; <font color="#739FCF"><b>WKR-</b></font>
&#9474;&nbsp;&nbsp; &#9500;&#9472;&#9472; <font color="#739FCF"><b>WKZ+</b></font>
&#9474;&nbsp;&nbsp; &#9492;&#9472;&#9472; <font color="#739FCF"><b>WKZ-</b></font>
&#9500;&#9472;&#9472; <font color="#739FCF"><b>LAYERhspecF</b></font>
&#9474;&nbsp;&nbsp; &#9500;&#9472;&#9472; <font color="#739FCF"><b>WK00</b></font>
&#9474;&nbsp;&nbsp; &#9500;&#9472;&#9472; <font color="#739FCF"><b>WKR+</b></font>
&#9474;&nbsp;&nbsp; &#9500;&#9472;&#9472; <font color="#739FCF"><b>WKR-</b></font>
&#9474;&nbsp;&nbsp; &#9500;&#9472;&#9472; <font color="#739FCF"><b>WKZ+</b></font>
&#9474;&nbsp;&nbsp; &#9492;&#9472;&#9472; <font color="#739FCF"><b>WKZ-</b></font>
&#9500;&#9472;&#9472; <font color="#739FCF"><b>LAYERhspecS</b></font>
&#9474;&nbsp;&nbsp; &#9500;&#9472;&#9472; <font color="#739FCF"><b>Orig</b></font>
&#9474;&nbsp;&nbsp; &#9500;&#9472;&#9472; <font color="#739FCF"><b>WK00</b></font>
&#9474;&nbsp;&nbsp; &#9500;&#9472;&#9472; <font color="#739FCF"><b>WKR+</b></font>
&#9474;&nbsp;&nbsp; &#9500;&#9472;&#9472; <font color="#739FCF"><b>WKR-</b></font>
&#9474;&nbsp;&nbsp; &#9500;&#9472;&#9472; <font color="#739FCF"><b>WKZ+</b></font>
&#9474;&nbsp;&nbsp; &#9492;&#9472;&#9472; <font color="#739FCF"><b>WKZ-</b></font>
&#9500;&#9472;&#9472; <font color="#739FCF"><b>LAYERS.IMG</b></font>
&#9500;&#9472;&#9472; <font color="#739FCF"><b>LAYERspulse96</b></font>
&#9474;&nbsp;&nbsp; &#9500;&#9472;&#9472; <font color="#739FCF"><b>SW00</b></font>
&#9474;&nbsp;&nbsp; &#9500;&#9472;&#9472; <font color="#739FCF"><b>SWR+</b></font>
&#9474;&nbsp;&nbsp; &#9500;&#9472;&#9472; <font color="#739FCF"><b>SWR-</b></font>
&#9474;&nbsp;&nbsp; &#9500;&#9472;&#9472; <font color="#739FCF"><b>SWZ+</b></font>
&#9474;&nbsp;&nbsp; &#9492;&#9472;&#9472; <font color="#739FCF"><b>SWZ-</b></font>
&#9500;&#9472;&#9472; <font color="#739FCF"><b>LAYERspulse96F</b></font>
&#9474;&nbsp;&nbsp; &#9500;&#9472;&#9472; <font color="#739FCF"><b>SW00</b></font>
&#9474;&nbsp;&nbsp; &#9500;&#9472;&#9472; <font color="#739FCF"><b>SWR+</b></font>
&#9474;&nbsp;&nbsp; &#9500;&#9472;&#9472; <font color="#739FCF"><b>SWR-</b></font>
&#9474;&nbsp;&nbsp; &#9500;&#9472;&#9472; <font color="#739FCF"><b>SWZ+</b></font>
&#9474;&nbsp;&nbsp; &#9492;&#9472;&#9472; <font color="#739FCF"><b>SWZ-</b></font>
&#9500;&#9472;&#9472; <font color="#739FCF"><b>LAYERspulse96S</b></font>
&#9474;&nbsp;&nbsp; &#9500;&#9472;&#9472; <font color="#739FCF"><b>Orig</b></font>
&#9474;&nbsp;&nbsp; &#9500;&#9472;&#9472; <font color="#739FCF"><b>SW00</b></font>
&#9474;&nbsp;&nbsp; &#9500;&#9472;&#9472; <font color="#739FCF"><b>SWR+</b></font>
&#9474;&nbsp;&nbsp; &#9500;&#9472;&#9472; <font color="#739FCF"><b>SWR-</b></font>
&#9474;&nbsp;&nbsp; &#9500;&#9472;&#9472; <font color="#739FCF"><b>SWZ+</b></font>
&#9474;&nbsp;&nbsp; &#9492;&#9472;&#9472; <font color="#739FCF"><b>SWZ-</b></font>
&#9500;&#9472;&#9472; <font color="#739FCF"><b>LAYERspulse96strainF</b></font>
&#9500;&#9472;&#9472; <font color="#739FCF"><b>LAYERspulse96strainS</b></font>
&#9500;&#9472;&#9472; <font color="#739FCF"><b>src</b></font>
&#9500;&#9472;&#9472; <font color="#739FCF"><b>TEST.SW</b></font>
&#9474;&nbsp;&nbsp; &#9500;&#9472;&#9472; <font color="#739FCF"><b>DIR.I.A</b></font>
&#9474;&nbsp;&nbsp; &#9500;&#9472;&#9472; <font color="#739FCF"><b>DIR.I.D</b></font>
&#9474;&nbsp;&nbsp; &#9492;&#9472;&#9472; <font color="#739FCF"><b>DIR.I.V</b></font>
&#9500;&#9472;&#9472; <font color="#739FCF"><b>TEST.WK</b></font>
&#9474;&nbsp;&nbsp; &#9500;&#9472;&#9472; <font color="#739FCF"><b>DIR.I.A</b></font>
&#9474;&nbsp;&nbsp; &#9500;&#9472;&#9472; <font color="#739FCF"><b>DIR.I.D</b></font>
&#9474;&nbsp;&nbsp; &#9492;&#9472;&#9472; <font color="#739FCF"><b>DIR.I.V</b></font>
&#9500;&#9472;&#9472; <font color="#739FCF"><b>WHOLEhpulse96strain</b></font>
&#9500;&#9472;&#9472; <font color="#739FCF"><b>WHOLEhspec</b></font>
&#9474;&nbsp;&nbsp; &#9500;&#9472;&#9472; <font color="#739FCF"><b>Orig</b></font>
&#9474;&nbsp;&nbsp; &#9500;&#9472;&#9472; <font color="#739FCF"><b>WK00</b></font>
&#9474;&nbsp;&nbsp; &#9500;&#9472;&#9472; <font color="#739FCF"><b>WKR+</b></font>
&#9474;&nbsp;&nbsp; &#9500;&#9472;&#9472; <font color="#739FCF"><b>WKR-</b></font>
&#9474;&nbsp;&nbsp; &#9500;&#9472;&#9472; <font color="#739FCF"><b>WKZ+</b></font>
&#9474;&nbsp;&nbsp; &#9492;&#9472;&#9472; <font color="#739FCF"><b>WKZ-</b></font>
&#9500;&#9472;&#9472; <font color="#739FCF"><b>WHOLEhwhole</b></font>
&#9474;&nbsp;&nbsp; &#9500;&#9472;&#9472; <font color="#739FCF"><b>Orig</b></font>
&#9474;&nbsp;&nbsp; &#9500;&#9472;&#9472; <font color="#739FCF"><b>WK00</b></font>
&#9474;&nbsp;&nbsp; &#9500;&#9472;&#9472; <font color="#739FCF"><b>WKR+</b></font>
&#9474;&nbsp;&nbsp; &#9500;&#9472;&#9472; <font color="#739FCF"><b>WKR-</b></font>
&#9474;&nbsp;&nbsp; &#9500;&#9472;&#9472; <font color="#739FCF"><b>WKZ+</b></font>
&#9474;&nbsp;&nbsp; &#9492;&#9472;&#9472; <font color="#739FCF"><b>WKZ-</b></font>
&#9492;&#9472;&#9472; <font color="#739FCF"><b>WHOLE.IMG</b></font>
<br><br><br></pre>
    <h1 <a="" name="Theory">Theory</h1>
    <p> The theory describing the creation of Green's functions using
      modal superposition and an extension to compute stress and strain
      is given in <a href="strain.pdf?"> strain.pdf</a>. </p>
    <h1 <a="" href="Program">Programs</h1>
    <h2>srotate96</h2>
    <p> The program <b>spulse96strain</b> can output the three
      component ground motions, the cylindrical strains and stresses. <b>srotate96</b>
      implements the rotation discussed at the end of <a
        href="strain.pdf?"> strain.pdf</a> to rotate the cylindrical
      strains and stresses to a local Cartesian system show in the next
      figure. </p>
    <table>
      <tbody>
        <tr>
          <td><img src="xyrt.png"></td>
        </tr>
      </tbody>
    </table>
    <p> Here the <i>x-</i> and <i>y-</i>axes might represent the
      orientations of a strain sensor and the <i>r-</i> direction the
      direction of the propagating wave. </p>
    <p> The syntax for the command is very simple: </p>
    <pre><br>Usage: srotate96 -AZ az [-U|-STRESS|-STRAIN] -FILE prototype<br>  -AZ az (required) angle between r- and x-axes<br>  -FILE prototype (required) identifier for filename <br>       for the example below this could be ../NEW/005000_0100_0010<br> -U  Rotate the Ur Ut Uz from [sh]pulse96strain to Ux Uy Uz<br>       if they exist, e.g., ../NEW/005000_0100_0010.Ur etc<br>       to create 005000_0100_0010_Ux etc in the current directory<br> -STRAIN  Rotate the Err Erf .. Ezz  from [sh]pulse96strain to Exx Eyy ..<br>       if they exist, e.g., ../NEW/005000_0100_0010.Err etc<br>       to create 005000_0100_0010_Exx etc in the current directory<br> -STRESS  Rotate the Srr Srf .. Szz  from [sh]pulse96strain to Sxx Syy ..<br>       if they exist, e.g., ../NEW/005000_0100_0010.Srr etc<br>       to create 005000_0100_0010_Sxx etc in the current directory<br> -ROTATE  Rotate the Wrf Wrz Wfz  from [sh]pulse96strain to Wxy Wxz Wyz<br>       if they exist, e.g., ../NEW/005000_0100_0010.Wrf etc<br>       to create 005000_0100_0010_Wxy etc in the current directory<br> -h           (default false) online help <br></pre>
    <i>az</i> is the angle &#952; in degrees shown in the figure. The Example
    <p> Assume that the command <b>spulse96strain</b> created the files
    </p>
    <pre>05000_0100_0010.Eff	005000_0100_0010.Ezz	005000_0100_0010.Srz
005000_0100_0010.Efz	005000_0100_0010.Sff	005000_0100_0010.Szz
005000_0100_0010.Erf	005000_0100_0010.Sfz	005000_0100_0010.Ur
005000_0100_0010.Err	005000_0100_0010.Srf	005000_0100_0010.Ut
005000_0100_0010.Erz	005000_0100_0010.Srr	005000_0100_0010.Uz
</pre>
    in the directory <i>../NEW</i>
    <p> Then </p>
    <pre>     srotate96 -AZ 0.0  -STRESS -FILE ../NEW/005000_0100_0030
</pre>
    creates the following files in the current directory:
    <pre>005000_0100_0030_Exx	005000_0100_0030_Eyz	005000_0100_0030_Sxz	005000_0100_0030_Ux
005000_0100_0030_Exy	005000_0100_0030_Ezz	005000_0100_0030_Syy	005000_0100_0030_Uy
005000_0100_0030_Exz	005000_0100_0030_Sxx	005000_0100_0030_Syz	005000_0100_0030_Uz
005000_0100_0030_Eyy	005000_0100_0030_Sxy	005000_0100_0030_Szz
</pre>
    Note that the prevent confusion the original file extension followed
    the <i>.</i> while the rotated components use the <i>_</i> as a
    separator.
    <h2>spulse96strain</h2>
    <p> This program was built upon two programs in the Computer
      Programs in Seismology package: <b>spulse96</b> and <b>f96tosac</b>.
      Thus it maintains the functionality of the combined use of those
      two programs. In addition strains and stresses can be computed. </p>
    <p>As with <b>spulse96</b> the surface wave eigenfunctions must be
      computed using the <b>sprep96, sdisp96, sregn96, slegn96</b>
      sequence. The command is given by the following </p>
    <p> </p>
    <pre>quake: ~ rbh$ spulse96strain -h<br>USAGE: <br>spulse96strain -d Distance_File [ -t -o -p -i ] [-a alpha]<br>    -l L [ -D|-V |A]  [-F rfile ] [ -m mult] [-STEP|-IMP]<br>    [-STRESS  -STRAIN -ROTATE -GRN] [-FUND] [-HIGH] [-Z] <br>    [-LAT] [-2] [ -M mode ] [-LOCK] -FMT ifmt <br>    [-M0 moment ] [-MW mw] [-STK stk -DIP dip -RAKE rake]<br>    [-FX fx -FY fy -FZ fz] <br>    [-XX Mxx ... -ZZ Mzz] [-?] [-h]<br> TIME FUNCTION SPECIFICATION<br>  -t           Triangular pulse of base 2 L dt<br>  -p           Parabolic Pulse of base  4 L dt<br>                  -p -l 1 recommended<br>  -l L         (default 1 )duration control parameter<br>  -o           Ohnaka pulse with parameter alpha<br>  -i           Dirac Delta function<br>  -a alpha     Shape parameter for Ohnaka pulse<br>  -F rfile     User supplied pulse<br>  -m mult      Multiplier (default 1.0)<br>  -STEP        (default)<br>  -IMP         <br>              By default the source time function is <br>              steplike. -IMP forces impulse like. -D -IMP is Green s function<br> OUTPUT FILE NAME<br>  The format for the name of the binary output attempts to<br>  give information on epicentral distance (km), <br>  source depth (km), and receiver depth(km). The options are<br>  -FMT 1      DDDDDd_HHHh_ZZZz.cmp<br>              e.g. 005001_1234_0045.Uz<br>  -FMT 2      DDDDDddd_HHHhhh_ZZZzzz.cmp<br>              e.g. 00500123_123456_004578.Erf<br>  -FMT 3      DDDDDdHHHh.grn(default)<br>              e.g. 0050010041.ZVF<br>  -FMT 4      DDDDdHHHh.grn<br>              e.g. 050010045.Srz<br>  -FMT 5      DDDdddHhhh.grn<br>              e.g. 5001234578.Err<br>  where D is for epicentral distance, H source depth, and<br>  Z receiver depth. The lower case indicates the digits <br>  to the right of the decimal place.  The examples above<br>  are for an epicentral distance is 500.123 km, source<br>  depth 123.456 km and receiver depth 4.578 km.<br> OUTPUT TIMESERIES FOR SOURCE as Ur, Ut, Uz components with strain, stress optional<br>  -D           Output is ground displacement        (m)<br>  -V           Output is ground velocity (default) (m/s)<br>  -A           Output is ground acceleration       (m/s^2)<br>  -STRESS (default .false. ) output stress for mechanism<br>    units are Pa, with suffix Srr, Srf, Srz, Stt, Sfz, Szz<br>  -STRAIN (default .false. ) output strain for mechanism<br>       with suffix, Err, Erf, Erz, Eff, Efz, Ezz<br>  -ROTATE (default .false. ) output rotation for mechanism<br>       with suffix, Wfz, Wrz, Wrf<br>  -GRN    (default false) Output Green;s functions<br>    spulse96strain -STEP -V -p -l 1 -GRN -FMT 4  is same as<br>     spulse96 -V -p -l 1 | f96tosac -G . For KM,KM/S,GM/CM^3<br>     model, output will be CM/S for moment of 1.0e+20 dyne-cm<br>     of force of 1.0e+15 dyne<br>  -TEST1  (default .false.) output CPS Green functions ,e.g.,<br>       ZDS RDS ... RHF THF for use with moment tensor codes<br>       and gsac MT command. This is equivalent to <br>       spulse96 -V -p -l 1 | f96tosac -G if -FMT 4 is used <br>       with strainspulse96<br> COMPUTATIONS<br>  -d Distance_File {required}    Distance control file <br>   This contains one of more lines with following entries<br>   DIST(km) DT(sec) NPTS T0(sec) VRED(km/s) <br>            first time point is T0 + DIST/VRED<br>            VRED=0 means do not use reduced travel time, e.g.<br>            500.0 0.25 512 -23.33 6.0<br>            500.0 0.25 512  60    0.0 <br>            both have first sample at travel time of 60s<br>  -LAT       (default false) Laterally varying eigenfunctions<br>  -2         (default false) Use double length  internally<br>  -M  nmode  (default all) mode to compute [0=fund,1=1st]<br>  -Z         (default false) zero phase triangular/parabolic pulse<br>  -FUND       (default all) fundamental modes only  <br>  -HIGH       (default all) all higher modes only  <br>  -LOCK       (default false) locked mode used  <br> SOURCE MECHANISM SPECIFICATION<br>  -DIP dip               dip of fault plane<br>  -STK Strike            strike of fault plane<br>  -RAKE Rake              slip angle on fault plane<br>  -M0 Moment (def=1.0) Seismic moment in units of dyne-cm<br>  -MW mw            Moment Magnitude  <br>            moment (dyne-cm) from log10 Mom = 16.10 + 1.5 Mw<br>            For strike,dip,rake source mw or Moment must be specified<br>  -EX                  Explosion<br>  -AZ Az                Source to Station Azimuth<br>  -BAZ Baz               Station to Source azimuth<br>  -fx FX -fy Fy -fZ fz  Point force amplitudes  (N,E,down) in  dynes<br>  -XX Mxx -YY Myy -ZZ Mzz  Moment tensor elements in units of<br>  -XY Mxy -XZ Mxz -YZ Myz    dyne-cm<br> The moment tensor coordinates are typically X = north Y = east and Z = down<br> If by accident more than one source specification is used,<br> the hierarchy is Mij &gt; Strike,dip,rake &gt; Explosion &gt; Force<br> --------------------------------------------------------------<br> NOTE: The output units are related tot he model specification.<br> To have the desired units the model must be in KM, KM/S  and GM/CM^3<br> --------------------------------------------------------------<br>  -?           Write this help message<br>  -h           Write this help message<br><br>&nbsp;
 
</pre>
    This is an extensive on-line help, however the example provided in
    the validation code shows how easy it is to run.<br>
    <br>
    <h2>hspec96strain and hpulse96strain</h2>
    <b>hspec96strain </b>is an extension of <b>hspec96</b> to also
    compute the vertical and radial deriveatives of the Green's
    functions at the receiver position as well as the Green's functions
    themselves. The command line options are identical to both codes:
    <pre>$ hspec96strain -h<br>&nbsp;USAGE: hspec96 [-H] [-A arg] [-K] [-N][-SU] [-SD] [-SPUP] [-SSUP] [-SPDN] [-SSDN] [-RU] [-RD] [-RPUP] [-RSUP] [-RPDN] [-RSDN] [-?] [-h]<br>&nbsp;-H (default false)&nbsp;&nbsp; Use Hankel function not Bessel<br>&nbsp;-A arg (default arg=3.0) value of kr where Hn(kr) replaces<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Jn(kr) in integration - only used when -H is used<br>&nbsp;-K&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (default Futterman) use Kjartansson Causal Q<br>&nbsp;-N&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (default causal) use non-causal Q<br>&nbsp;The following govern wavefield at source. The default is the entire wavefield<br>&nbsp;-SU&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (default whole wavefield) Compute only upgoing&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; wavefield from the source<br>&nbsp;-SD&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (default whole wavefield) Compute only downgoing&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; wavefield from the source<br>&nbsp; -SPUP&nbsp; Include upward P at source<br>&nbsp; -SSUP&nbsp; Include upward S at source<br>&nbsp; -SPDN&nbsp; Include downward P at source<br>&nbsp; -SSDN&nbsp; Include downward S at source<br>&nbsp;The following govern wavefield at receiver. The default is the entire wavefield<br>&nbsp; -RD&nbsp;&nbsp;&nbsp; Only downgoing waves at receiver<br>&nbsp; -RU&nbsp;&nbsp;&nbsp; Only upgoing waves at receiver<br>&nbsp; -RPUP&nbsp; Include upward P at receiver<br>&nbsp; -RSUP&nbsp; Include upward S at receiver<br>&nbsp; -RPDN&nbsp; Include downward P at receiver<br>&nbsp; -RSDN&nbsp; Include downward S at receiver<br>&nbsp;-?&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Display this usage message<br>&nbsp;-h&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Display this usage message</pre>
    The command line options for <b>hpulse96strain </b>are similar to
    those of <b>spulse96strain</b>:<br>
    <br>
    <br>
    <pre>USAGE: <br>hpulse96strain -d Distance_File [ -t -o -p -i ] [-a alpha]<br>    -l L [ -D|-V |A]  [-F rfile ] [ -m mult] [-STEP|-IMP]<br>    [-STRESS  -STRAIN -ROTATE -GRN] [-FUND] [-HIGH] [-Z] <br>    [-LAT] [-2] [ -M mode ] [-LOCK] -FMT ifmt <br>    [-M0 moment ] [-MW mw] [-STK stk -DIP dip -RAKE rake]<br>    [-FX fx -FY fy -FZ fz] <br>    [-XX Mxx ... -ZZ Mzz] [-?] [-h]<br> TIME FUNCTION SPECIFICATION<br>  -t           Triangular pulse of base 2 L dt<br>  -p           Parabolic Pulse of base  4 L dt<br>                  -p -l 1 recommended<br>  -l L         (default 1 )duration control parameter<br>  -o           Ohnaka pulse with parameter alpha<br>  -i           Dirac Delta function<br>  -a alpha     Shape parameter for Ohnaka pulse<br>  -F rfile     User supplied pulse<br>  -m mult      Multiplier (default 1.0)<br>  -STEP        (default)<br>  -IMP         <br>              By default the source time function is <br>              steplike. -IMP forces impulse like. -D -IMP is Green s function<br> OUTPUT FILE NAME<br>  The format for the name of the binary output attempts to<br>  give information on epicentral distance (km), <br>  source depth (km), and receiver depth(km). The options are<br>  -FMT 1      DDDDDd_HHHh_ZZZz.cmp<br>              e.g. 005001_1234_0045.Uz<br>  -FMT 2      DDDDDddd_HHHhhh_ZZZzzz.cmp<br>              e.g. 00500123_123456_004578.Erf<br>  -FMT 3      DDDDDdHHHh.grn(default)<br>              e.g. 0050010041.ZVF<br>  -FMT 4      DDDDdHHHh.grn<br>              e.g. 050010045.Srz<br>  -FMT 5      DDDdddHhhh.grn<br>              e.g. 5001234578.Err<br>  where D is for epicentral distance, H source depth, and<br>  Z receiver depth. The lower case indicates the digits <br>  to the right of the decimal place.  The examples above<br>  are for an epicentral distance is 500.123 km, source<br>  depth 123.456 km and receiver depth 4.578 km.<br> OUTPUT TIMESERIES FOR SOURCE as Ur, Ut, Uz components with strain, stress optional<br>  -D           Output is ground displacement        (m)<br>  -V           Output is ground velocity (default) (m/s)<br>  -A           Output is ground acceleration       (m/s^2)<br>  -STRESS (default .false. ) output stress for mechanism<br>    units are Pa, with suffix Srr, Srf, Srz, Stt, Sfz, Szz<br>  -STRAIN (default .false. ) output strain for mechanism<br>       with suffix, Err, Erf, Erz, Eff, Efz, Ezz<br>  -ROTATE (default .false. ) output rotation for mechanism<br>       with suffix, Wfz, Wrz, Wrf<br>  -GRN    (default false) Output Green;s functions<br>    hpulse96strain -STEP -V -p -l 1 -GRN -FMT 4  is same as<br>     hpulse96 -V -p -l 1 | f96tosac -G . For KM,KM/S,GM/CM^3<br>     model, output will be CM/S for moment of 1.0e+20 dyne-cm<br>     of force of 1.0e+15 dyne<br><br>  -TEST1  (default .false.) output CPS Green functions ,e.g.,<br>       ZDS RDS ... RHF THF for use with moment tensor codes<br>       and gsac MT command. This is equivalent to <br>       spulse96 -V -p -l 1 | f96tosac -G if -FMT 4 is used <br>       with strainspulse96<br> COMPUTATIONS<br>  -Z         (default false) zero phase <br> SOURCE MECHANISM SPECIFICATION<br>  -DIP dip               dip of fault plane<br>  -STK Strike            strike of fault plane<br>  -RAKE Rake              slip angle on fault plane<br>  -M0 Moment (def=1.0) Seismic moment in units of dyne-cm<br>  -MW mw            Moment Magnitude  <br>            moment (dyne-cm) from log10 Mom = 16.10 + 1.5 Mw<br>            For strike,dip,rake source mw or Moment must be specified<br>  -EX                  Explosion<br>  -AZ Az                Source to Station Azimuth<br>  -BAZ Baz               Station to Source azimuth<br>  -fx FX -fy Fy -fZ fz  Point force amplitudes  (N,E,down) in  dynes<br>  -XX Mxx -YY Myy -ZZ Mzz  Moment tensor elements in units of<br>  -XY Mxy -XZ Mxz -YZ Myz    dyne-cm<br> The moment tensor coordinates are typically X = north Y = east and Z = down<br> If by accident more than one source specification is used,<br> the hierarchy is Mij &gt; Strike,dip,rake &gt; Explosion &gt; Force<br> --------------------------------------------------------------<br> NOTE: The output units are related tot he model specification.<br> To have the desired units the model must be in KM, KM/S  and GM/CM^3<br> --------------------------------------------------------------<br>  -?           Write this help message<br>  -h           Write this help message<br></pre>
    <br>
    <br>
    <br>
    <br>
    <h1 <a="" name="Validation" <="" a="">Validation tests</h1>
    <h3>Moment tensor source</h3>
    <p> The validation code is contained in <a href="teststrain.tgz">teststrain.tgz</a>.
      This uses the codes distributed in Computer Programs in
      Seismology. However to make the PNG graphics used here the
      ImageMagick <b>convert</b> program is used. ImageMagick is
      available for macOS and LINUX. To unpack and run the tests, <br>
    </p>
    <pre>gunzip -c teststrain.tgz | tar xf -

cd CPSstrain
(cd SWkm;
	(cd SW00;DOITSW)
	(cd SWZ+;DOITSW)
	(cd SWZ-;DOITSW)
	(cd SWR+;DOITSW)
	(cd SWR-;DOITSW)
)
(cd WKkm;
	(cd WK00;DOITWK)
	(cd WKZ+;DOITWK)
	(cd WKZ-;DOITWK)
	(cd WKR+;DOITWK)
	(cd WKR-;DOITWK)
)
DOSTRAINCMP
</pre>
    <p>Using <b>spulse96</b> and <b>f96tosac</b>, it creates surface
      wave modal superposition Green's functions in the <i>SWkm</i>
      directory for epicentral distances of 499.5 (sub-directory SWR-),
      500.0 (sub-directory SW00) an 500.5 (sub-directory SWR+) km and
      receiver depths of 1.0 km (SW00), 0.5 km (SWZ-) and 1.5 km (SWZ+).
    </p>
    <p> Similar computations are done using wavenumber integration in
      the directory WKkm and subdirectories WK00, WKZ-, WKZ+, WKR- and
      WKR+. These are complete solutions which include P waves and
      near-field terms. The purpose is to compare the surface-wave
      synthetics to the complete solution. </p>
    <p> The final script <i>DOSTRAINCMP</i> runs <i>DOITSW</i> in the
      NEW directory. After defining the model and generating the
      eigenfunctions and dispersion, the following command is run: </p>
    <pre><b>spulse96strain</b><i> -V -p -l 1 -d dfile -MW 2.6 -STK 0 -DIP 45 -RAKE 90 -AZ 22.5 -STRESS -STRAIN -FMT 1 </i>
</pre>
    The following files in Sac format are created:
    <pre>005000_0100_0010.Eff	005000_0100_0010.Ezz	005000_0100_0010.Srz
005000_0100_0010.Efz	005000_0100_0010.Sff	005000_0100_0010.Szz
005000_0100_0010.Erf	005000_0100_0010.Sfz	005000_0100_0010.Ur
005000_0100_0010.Err	005000_0100_0010.Srf	005000_0100_0010.Ut
005000_0100_0010.Erz	005000_0100_0010.Srr	005000_0100_0010.Uz
</pre>
    <p> The <i>DOSTRAINCMP</i>, then runs the scripts <i>DOSTRAINF</i>
      in the SWkm and WKkm directories. Those scripts create synthetics
      for a given mechanism, moment and azimuth, and then numerically
      differentiates these to give the strains. The values used for the
      <i>dR</i>, <i>dZ</i> and <i>dAz</i> are appropriate for the
      sampling interval and source pulse duration used. The next figures
      compare the three estimates of ground velocity and strain. </p>
    <p>
      <table>
        <tbody>
          <tr>
            <td>
              <center>Predicted velocity in m/s</center>
              <br>
              <img src="U.png">
              <hr> </td>
          </tr>
          <tr>
            <td>
              <center>Predicted strain</center>
              <br>
              <img src="E1.png">
              <hr> </td>
          </tr>
          <tr>
            <td>
              <center>Predicted strain</center>
              <br>
              <img src="E2.png">
              <hr> </td>
          </tr>
          <tr>
            <td>
              <center> In these figures the red curves were created by <b>spulse96strain</b>
                in the NEW directory, the black by modal superposition
                in the SWkm directory, and the blue by wavenumber
                integration in the WKkm directory. The black and blue
                colored strain values were computed by numerical
                differentiation. These figures highlight the fact that
                the modal superposition synthetics cannot describe the
                signals between P and S. The slight difference in strain
                using <b>spulse96strain</b> and the numerical
                differentiation are due to the approximate nature of the
                numerical method. If a longer source pulse were used,
                these difference would be significantly less. </center>
            </td>
          </tr>
        </tbody>
      </table>
    </p>
    <h3>Point force test</h3>
    <p> In this case the response to a point force fx=Fy=fz=1.0e+15 dyne
      is computed. The validation code is contained in <a
        href="teststrain.tgz">teststrain.tgz</a>. To unpack and run the
      tests, <br>
    </p>
    <pre>gunzip -c teststrain.tgz | tar xf -

cd CPSstrain
(cd SWkm;
	(cd SW00;DOITSW)
	(cd SWZ+;DOITSW)
	(cd SWZ-;DOITSW)
	(cd SWR+;DOITSW)
	(cd SWR-;DOITSW)
)
(cd WKkm;
	(cd WK00;DOITWK)
	(cd WKZ+;DOITWK)
	(cd WKZ-;DOITWK)
	(cd WKR+;DOITWK)
	(cd WKR-;DOITWK)
)                         [note the above steps were executed in the previous example]
DOSTRAINCMPF
</pre>
    <p> </p>
    <p> The final script <i>DOSTRAINCMPF</i> runs <i>DOITSWF</i> in
      the NEW directory. After defining the model and generating the
      eigenfunctions and dispersion, the following command is run: </p>
    <pre><b>spulse96strain</b><i>-V -p -l 1 -d dfile -fx ${F1} -fy ${F2} -fz ${F3} -STRESS -STRAIN -AZ ${AZ}  -FMT 1
 </i>
</pre>
    As above the following files in Sac format are created:
    <pre>005000_0100_0010.Eff	005000_0100_0010.Ezz	005000_0100_0010.Srz
005000_0100_0010.Efz	005000_0100_0010.Sff	005000_0100_0010.Szz
005000_0100_0010.Erf	005000_0100_0010.Sfz	005000_0100_0010.Ur
005000_0100_0010.Err	005000_0100_0010.Srf	005000_0100_0010.Ut
005000_0100_0010.Erz	005000_0100_0010.Srr	005000_0100_0010.Uz
</pre>
    <p> The <i>DOSTRAINCMPF</i>, then runs the scripts <i>DOSTRAINF</i>
      in the SWkm and WKkm directories. Those scripts create synthetics
      for a given mechanism, moment and azimuth, and then numerically
      differentiates these to give the strains. The values used for the
      <i>dR</i>, <i>dZ</i> and <i>dAz</i> are appropriate for the
      sampling interval and source pulse duration used. The next figures
      compare the three estimates of ground velocity and strain. </p>
    <p>
      <table>
        <tbody>
          <tr>
            <td>
              <center>Predicted velocity in m/s</center>
              <br>
              <img src="UF.png">
              <hr> </td>
          </tr>
          <tr>
            <td>
              <center>Predicted strain</center>
              <br>
              <img src="E1F.png">
              <hr> </td>
          </tr>
          <tr>
            <td>
              <center>Predicted strain</center>
              <br>
              <img src="E2F.png">
              <hr> </td>
          </tr>
          <tr>
            <td>
              <center> In these figures the red curves were created by <b>spulse96strain</b>
                in the NEW directory, the black by modal superposition
                in the SWkm directory, and the blue by wavenumber
                integration in the WKkm directory. The black and blue
                colored strain values were computed by numerical
                differentiation. These figures highlight the fact that
                the modal superposition synthetics cannot describe the
                signals between P and S. The slight difference in strain
                using <b>spulse96strain</b> and the numerical
                differentiation are due to the approximate nature of the
                numerical method. If a longer source pulse were used,
                these difference would be significantly less. </center>
            </td>
          </tr>
        </tbody>
      </table>
    </p>
    <p> This comparison is fairly good, except for the wavenumber
      integration estimate of the <i>Eff</i> = <i>E<sub>&#966;&#966;</sub></i>
      component. The dominant contribution to this the <i>u<sub>r</sub></i>.
      Perhaps the near-field terms ignored int he modal superposition is
      important in this case. </p>
    <h2>Units </h2>
    <p> Synthetic seismogram code runs on the basis of numerical values
      given for the model. The code has no sense of physical units. These strain codes
      are tailored to the use of KM, KM/S and GM/CM<sup>3</sup> for
      depth, velocity and density. The epicentral distances, and
      source/receiver depths are also assumed to be KM. Internally the
      code corrects everything to MKS units, e.g., M, KG/M<sup>3</sup>,
      S units so that the strain and stress are correctly computed. On
      output the units are </p>
    <pre>Uz, Ur, Ut      -D flag     displacement in meters
                -V flag     velocity     in meters/s
                -A flag     acceleration in meters/s/s
Err ... Ezz     -STRAIN     dimensionless (meter/meter)
Srr ... Szz     -STRESS     stress       in Pa
</pre>
    <h2>The code</h2>
    <p> After some further testing, <b>spulse96strain</b> and <b>srotate96</b>
      will be part of the Computer Programs in Seismology distribution.
      To make this tool available, you will need to download <a
        href="strainspulse96.f">spulse96strain.f</a>, <a
        href="srotate96.c">srotate96.c</a>, <a href="makeadd.txt">makeadd.txt</a>
      and <a href="makeadd1.txt">makeadd1.txt</a> and <a
        href="makeall.txt">makeall.txt</a>, and perform the following
      steps: </p>
    <p> </p>
    <pre>cd PROGRAMS.330/VOLIII/src

[copy the strainspulse96.f to this directory]
[carefully edit the  Makefile to change the lines

sacsubf.o:
        cp ../../SUBS/sacsubf.f .
        $(FCMP) -c sacsubf.f

all: sprep96 sdisp96 \
	sdpsrf96 sdpegn96 sdpder96 \
	slegn96 sregn96 \
	slat2d96 \
	spulse96 \
	scomb96 \
	sdpdsp96 \
	sdprad96 \
	sdpspc96 \
	srfgrd96 \
	tprep96  tdisp96  tregn96  tlegn96  tdpsrf96  tdpegn96  tdpder96 tpulse96  tcomb96 \
	clean

to

sacsubf.o:
        cp ../../SUBS/sacsubf.f .
        $(FCMP) -c sacsubf.f

sacsubc.c:
	cp ${CPS}/SUBS/sacsubc.c .

sacsubc.h:
	cp ${CPS}/SUBS/sacsubc.h .

all: sprep96 sdisp96 \
	sdpsrf96 sdpegn96 sdpder96 \
	slegn96 sregn96 \
	slat2d96 \
	spulse96 \
	scomb96 \
	sdpdsp96 \
	sdprad96 \
	sdpspc96 \
	srfgrd96 \
	tprep96  tdisp96  tregn96  tlegn96  tdpsrf96  tdpegn96  tdpder96 tpulse96  tcomb96 \
	spulse96strain srotate96\
	clean

Finally change the section

spulse96:       spulse96.o $(SSUBS) f96subf.o lgstr.o $(GETMOD) $(MCHDEP) $(MCHCMD)
        $(FCMP) spulse96.o $(SSUBS) f96subf.o lgstr.o $(GETMOD) $(MCHDEP) $(MCHCMD) -o spulse96
        mv spulse96 $(DEST)


scomb96:        scomb96.o $(SSUBS) $(MCHDEP) $(MCHCMD)
        $(FCMP) scomb96.o $(SSUBS) $(MCHDEP) $(MCHCMD) -o scomb96
        mv scomb96 $(DEST)

to

spulse96:       spulse96.o $(SSUBS) f96subf.o lgstr.o $(GETMOD) $(MCHDEP) $(MCHCMD)
        $(FCMP) spulse96.o $(SSUBS) f96subf.o lgstr.o $(GETMOD) $(MCHDEP) $(MCHCMD) -o spulse96
        mv spulse96 $(DEST)

spulse96strain: spulse96strain.o sacsubf.o $(SSUBS) f96subf.o lgstr.o $(GETMOD) $(MCHDEP) $(MCHCMD)
	$(FCMP) spulse96strain.o sacsubf.o $(SSUBS) f96subf.o lgstr.o $(GETMOD) $(MCHDEP) $(MCHCMD) -o spulse96strain
	mv spulse96strain $(DEST)



scomb96:        scomb96.o $(SSUBS) $(MCHDEP) $(MCHCMD)
        $(FCMP) scomb96.o $(SSUBS) $(MCHDEP) $(MCHCMD) -o scomb96
        mv scomb96 $(DEST)


srotate96: srotate96.o sacsubc.o
	${CCMP} -o srotate96 srotate96.o sacsubc.o -lm
	mv srotate96 $(DEST)

</pre>
    Note that in the Makefile there are no leading spaces. The offset
    are due to a TAB.
    <p> Now </p>
    <pre>make all

or

make spulse96strain srotate96 clean
</pre>
    <center>Last changed March 21, 2021</center>
  </body>
</html>
